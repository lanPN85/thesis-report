\documentclass[a4paper, 12pt, oneside]{report}
\usepackage[utf8]{inputenc}
\usepackage{amsfonts}
\usepackage[numbers,sort&compress]{natbib}
\usepackage{comment}
\usepackage[utf8]{vietnam}
\usepackage{amssymb}
\usepackage{url}
\usepackage{subfig}
\usepackage{fancybox}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{graphicx}
\usepackage{subfiles}
\usepackage[left=3.50cm, right=2.00cm, top=2.00cm, bottom=2.00cm]{geometry}
\usepackage{fancyhdr}
\usepackage{hyperref}
\usepackage{changepage}
\usepackage{framed}
\usepackage{multirow}
\usepackage{diagbox}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{tabu}
\usepackage{booktabs}
\usepackage{listings}
\usepackage{placeins}
\usepackage{multirow}
\usepackage{setspace}
% \usepackage[backend=biber, sorting=none]{biblatex}
\usepackage{listings}
\usepackage[nottoc]{tocbibind}
\usepackage[table,xcdraw]{xcolor}
\usepackage{float}
\floatstyle{plaintop}
\restylefloat{table}
\usepackage{caption}
\usepackage{subfig}
\usepackage[english]{babel}
\usepackage{amssymb}
\usepackage{pifont}
\usepackage[acronym, nonumberlist, shortcuts, toc]{glossaries}
\newcommand{\cmark}{\ding{51}}
\newcommand{\xmark}{\ding{55}}

\usepackage[linesnumbered,ruled,vlined]{algorithm2e}
\usepackage{algorithmic}
\SetAlFnt{\footnotesize}
\SetKw{KwDownTo}{downto}
\SetKw{KwTrue}{true}
\SetKw{KwFalse}{false}
\SetKwInOut{Input}{Input}
\SetKwInOut{Output}{Output}
\SetKw{KwAnd}{and}
\makeatletter
\newcommand{\nosemic}{\renewcommand{\@endalgocfline}{\relax}}
\newcommand{\dosemic}{\renewcommand{\@endalgocfline}{\algocf@endline}}
\newcommand{\pushline}{\Indp}
\newcommand{\popline}{\Indm\dosemic}
\let\oldnl\nl
\newcommand{\nonl}{\renewcommand{\nl}{\let\nl\oldnl}}
\makeatother

\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=blue,
    urlcolor=red 
}

\lstset{
    language=Python,
    numbers=none,
    tabsize=2,
    breaklines=true,
    basicstyle=\ttfamily\small,
    captionpos=t,
    stringstyle=\color{magenta},
    keywordstyle=\color{blue}\bfseries,
    numberstyle=\color{black}
}
\setlength{\parskip}{0.6em}

\makeatletter
\newcommand{\vast}{\bBigg@{4}}
\newcommand{\Vast}{\bBigg@{5}}
\newcommand{\vastl}{\mathopen\vast}
\newcommand{\vastm}{\mathrel\vast}
\newcommand{\vastr}{\mathclose\vast}
\newcommand{\Vastl}{\mathopen\Vast}
\newcommand{\Vastm}{\mathrel\Vast}
\newcommand{\Vastr}{\mathclose\Vast}
\makeatother

\renewcommand{\footrulewidth}{0.4pt}
\newcommand{\bigCI}{\mathrel{\text{\scalebox{1.07}{$\perp\mkern-10mu\perp$}}}}
\renewcommand{\baselinestretch}{1.2}

% \setcounter{page}{3}
\hypersetup{
    colorlinks=true,
    urlcolor=blue,
    linkcolor=black}
\graphicspath{ {images/} }
\lhead{}
\chead{}
\rhead{}

\makeglossaries
% \input{acronyms}
% \input{glossary}
\loadglsentries[\acronymtype]{acronyms}
\loadglsentries{glossary}

\setlength{\parindent}{1.25cm}
\setlength{\parskip}{10pt}
\setlength{\columnsep}{0.5125cm}
\renewcommand{\baselinestretch}{1.2}

\fancypagestyle{IHA-fancy-style}{%
  \fancyhf{}% Clear header and footer
  \fancyhead[L]{\textit{This thesis is performed by: Phan Ngoc Lan - 2014505 - CNTT2-2 - K59}}
  \fancyfoot[R]{\thepage}% Custom footer
  \renewcommand{\headrulewidth}{0.4pt}% Line at the header visible
  \renewcommand{\footrulewidth}{0pt}% Line at the footer visible
}
% Redefine the plain page style
\fancypagestyle{plain}{%
  \fancyhf{}% Clear header and footer
  \fancyhead[L]{\textit{This thesis is performed by: Phan Ngoc Lan - 2014505 - CNTT2-2 - K59}}
  \fancyfoot[R]{\thepage}% Custom footer
  \renewcommand{\headrulewidth}{0.4pt}% Line at the header visible
  \renewcommand{\footrulewidth}{0pt}% Line at the footer visible
}
\pagestyle{IHA-fancy-style}

\begin{document}
\begin{spacing}{1.25}
    \thispagestyle{empty}
    \thisfancypage{\setlength{\fboxrule}{1pt}\doublebox}{}
    \begin{center}
        {\fontsize{17}{20}\selectfont HANOI UNIVERSITY OF SCIENCE AND TECHNOLOGY} \\
        {\fontsize{13}{17}\selectfont SCHOOL OF INFORMATION AND COMMUNICATION TECHNOLOGY} \\ [0.25cm]
        \textbf{---------------*---------------} \\ [1cm]
        \includegraphics[width=0.2\textwidth]{hust.jpeg} \\ [1cm]
        {\fontsize{25}{30}\selectfont \textbf{THESIS}} \\ [0.25cm]
        {\fontsize{14}{17}\selectfont SUBMITTED IN PARTIAL FULFILLMENT \\
        OF THE REQUIREMENTS FOR THE DEGREE OF} \\ [0.5cm]
        {\fontsize{25}{30}\selectfont \textbf{ENGINEER OF TECHNOLOGY}} \\ [0.5cm]
        {\fontsize{14}{17}\selectfont IN} \\ [0.5cm]
        {\fontsize{22}{26}\selectfont INFORMATION TECHNOLOGY} \\ [0.5cm]
        {\fontsize{15}{15}\selectfont \textbf{BK.SYNAPSE:\\DISTRIBUTED NEURAL NETWORK\\ TRAINING FRAMEWORK\\ AND ITS APPLICATION IN OBJECT DETECTION}}
        \\ [2.25cm]
        \begin{tabular}{ l l }
            Author & : \textbf{Phan Ngoc Lan} \\
            & : CNTT2-2 K59 \\
            & : 20142505 \\ [0.5cm]
            Supervisor & : Dr \textbf{Dinh Viet Sang}
        \end{tabular} \\ [2.25cm]
        {\fontsize{17}{20}\selectfont HANOI, 5 - 2019}
    \end{center}
\end{spacing}
\pagebreak

\selectlanguage{english}
\fontsize {13pt}{16pt}
\selectfont

\pagenumbering{roman}
\setcounter{page}{1}
\begin{spacing}{1.0}
    \chapter*{Requirements for the Thesis}
    \section*{Student Information}
    \begin{itemize}
        \begin{multicols}{2}
        \item \textbf{Full name:} PHAN NGOC LAN
        \item \textbf{Class:} CNTT2-2 K59
        \item \textbf{Tel:} 094 979 1149
        \item \textbf{Email:} lan.pn142505@sis.hust.edu.vn
        \item \textbf{Program:} Full-time program
        \end{multicols}
        \item \textbf{This thesis is performed at:} Department of Computer Science
        - School of Information and
        Communication Technology
        \item \textbf{This thesis is performed: from} 22/01/2019 \textbf{to}
        24/05/2019
    \end{itemize}
    \section*{Goals of the Thesis}
        \begin{itemize}
        \item Design and implement a distributed neural network training framework.
        \item Apply the framework in training a neural network for the object detection problem.
        \end{itemize}
    \section*{Main Tasks of the Thesis}
        \begin{itemize}
        \item Study different approaches for training neural networks at scale.
        \item Study object detection techniques based on deep convolutional neural networks.
        \item Design and implement the framework.
        \item Implement a framework-compatible network for object detection.
        \item Present benchmark test results for the framework and evaluate the neural network model.
        \item Conclude and outline future developments.
        \end{itemize}
    
    \section*{Declaration of Student}
    I - Phan Ngoc Lan - hereby warrant that the work and presentation in this thesis are performed by myself under the supervision of \textit{Dr Dinh Viet Sang}.\\\\
    All results presented in this thesis are truthful and are not copied from any other works.\\\\
    \begin{minipage}{0.5\textwidth}
        \hfill
    \end{minipage}
    \begin{minipage}[t]{0.5\textwidth}
        \begin{center}
        \textit{Hanoi, 24th May, 2019\\Author\\[1cm]Phan Ngoc Lan}
        \end{center}
    \end{minipage}
    \subsection*{Attestation of the Supervisor on the Fulfillment of the
    Requirements for the Thesis:}
    \dotfill\\.\dotfill\\.\dotfill\\.\dotfill\\\\
    \begin{minipage}{0.5\textwidth}
        \hfill
    \end{minipage}
    \begin{minipage}[t]{0.5\textwidth}
        \begin{center}
    \textit{Hanoi, 24th May, 2019\\Supervisor\\[1cm]Dr Dinh Viet Sang}
        \end{center}
    \end{minipage}
\end{spacing}

\chapter*{Acknowledgments}
This thesis would not have been possible without my supervisor, Dr. Dinh Viet Sang. He has guided me with not just insight and advice, but also determination and passion. I learned a lot after completing this thesis, and I am proud to count myself among his students.

I would also like to thank all my lecturers at HUST, who've taught me so much throughout the 5 years that I've spent as a student, for which I am incredibly grateful.

My gratitude goes to my colleagues and supervisors at VNG and Viettel, all of whom have contributed some of their time, resources and experience in helping myself complete this work.

Finally, I want to thank my family, friends and loved ones, who have given me all the support and motivation I needed in the past 4 months. I am truly fortunate to be surrounded by such amazing people.

\pagebreak

\chapter*{Abstract}
Deep neural networks have seen many breakthroughs in the past several years, being applied to a wide variety of problems. Training these networks efficiently is a thoroughly-researched topic that plays an important role in their adoption. Major advancements have been made, including the use of multiple devices to further decrease training time. However, training at scale usually means adding on multiple layers of complex deployment logic and parallelization concerns, distracting researchers from the core of their algorithms. Therefore, this thesis presents a framework called BK.Synapse that can facilitate distributed training while maintaining clarity, simplicity, and user-friendliness. The design is modular, allowing flexible and easy deployment on a variety of hardware specifications. We benchmark BK.Synapse in a case study: training a neural network for an object detection problem. Our results show a good amount of speedup over conventional training, with very few modifications to the existing codebase.

\chapter*{Tóm tắt}
Mạng neuron đã có rất nhiều đột phá mạnh mẽ trong những năm gần đây, và đã được áp dụng vào rất nhiều bài toán thực tế. Huấn luyện các mạng này một cách hiệu quả là một chủ đề rất được quan tâm, đóng vai trò quan trọng trong việc thử nghiệm cũng như ứng dụng. Nhiều kĩ thuật huấn luyện đã được đề xuất, trong đó bao gồm việc sử dụng nhiều máy tính để tăng hiệu suất. Tuy nhiên, huấn luyện mạng trên quy mô lớn thường kéo theo nhiều tầng triển khai phức tạp và các vấn đề khác liên quan đến các tiến trình phân tán. Từ đó, đồ án đề xuất công cụ BK.Synapse, nhằm cho phép huấn luyện mạng neuron phân tán một cách rõ ràng, đơn giản và thân thiện với người dùng. Công cụ có thể được triển khai 1 cách linh hoạt trên nhiều cấu hình phần cứng. BK.Synapse được kiểm nghiệm thông qua bài toán huấn luyện mạng neuron cho một bài toán phát hiện vật thể. Các kết quả cho thấy tỉ lệ tăng tốc khá tốt so với huấn luyện thông thường, trong khi có chỉnh sửa khá ít so với mã nguồn gốc.

\chapter*{Summary}
The thesis is divided into 5 chapters:
\begin{itemize}
    \item Chapter 1 describes the problem of training neural networks at scale, as well as the object detection problem that would be used as a case study.
    \item Chapter 2 presents the theoretical background as well as related works, including machine learning, object detection and distributed training.
    \item Chapter 3 details the design and implementation of BK.Synapse - the proposed framework - and a case study where it is applied to an object detection problem.
    \item Chapter 4 reports on the results of several experiments and benchmarks.
    \item Chapter 5 presents our conclusions and lays out plans for future works.
\end{itemize}

\pagebreak
\pagenumbering{gobble}
\tableofcontents
\pagebreak
\pagenumbering{arabic}
\setcounter{page}{1}
\listoffigures
\listoftables

% \addcontentsline{toc}{chapter}{List of Abbreviations}
\printglossary[type=\acronymtype,style=long, title=List of Abbreviations]
% \addcontentsline{toc}{chapter}{Glossary}
\printglossary
\pagebreak

\subfile{problem.tex}
\subfile{theory.tex}
\pagebreak
\subfile{propose.tex}
\subfile{results.tex}

\chapter{Conclusions}
This thesis has presented BK.Synapse, a framework for distributed neural network training. Each component has been described in detail, with heavy emphasis on user workflow and integration with existing code. Despite being in early development, BK.Synapse shows a lot of promise as a high-level interface for distributed training, or simply as a management tool for training jobs. We also showcased the tool with a case study on RetinaNet for object detection, and received positive, if somewhat early-stage, results.

At the same time, there is much room for improving BK.Synapse, which motivates our future development efforts. Our future works include:
\begin{itemize}
    \item Improving security and multi-user workflow, with the goal of having a viable public deployment.
    \item Adding support for the planned deep learning frameworks (Keras and TensorFlow).
    \item Adding more features in terms of monitoring and customizing the training process.
\end{itemize}

\pagebreak
\bibliographystyle{plain}
\bibliography{thesis}
\end{document}
